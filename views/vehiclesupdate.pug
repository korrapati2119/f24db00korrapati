extends layout

block content
  h1 Update Vehicle Details

  form(action='/vehicles/update/?id=' + vehicle._id, method='POST')
    .form-group
      label(for='vehicle_name') Vehicle Name:
      input(type='text', id='vehicle_name', name='vehicle_name', class='form-control', value=vehicle.vehicle_name, required)

    .form-group
      label(for='price') Price:
      input(type='number', id='price', name='price', class='form-control', value=vehicle.price, required)

    .form-group
      label(for='functionality') Functionality:
      input(type='text', id='functionality', name='functionality', class='form-control', value=vehicle.functionality, required)

    button(type='submit', class='btn btn-primary') Update Vehicle

  // Client-side script to intercept form submission
  script.
    document.forms[0].addEventListener('submit', (event) => {
      event.preventDefault();
      // Show user that form is being submitted
      fetch(event.target.action, {
        method: 'POST',
        body: new URLSearchParams(new FormData(event.target)) // event.target is the form
      })
      .then((resp) => resp.json())
      .then((body) => {
        alert("Update succeeded!");
        // Optionally handle response body
        window.location.href = '/vehicles'; // Redirect after successful update
      })
      .catch((error) => {
        alert("Update failed: " + error);
        // Handle error
      });
    });
